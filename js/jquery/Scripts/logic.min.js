function _modifyFormationData(){for(var a in formations)for(var b=1,c=Object.keys(formations[a]).length;b<c;b++)formations[a][b].y=_modifyCoordinatesY(formations[a][b].y),formations[a][b].x=_modifyCoordinatesX(formations[a][b].x)}function _modifyCoordinatesX(a){return a>147?a=147+.85*(a-147):a<147?a=147-.9*(147-a):a}function _modifyCoordinatesY(a){return a=270-.8*(270-a)}function _getFormationsJSON(){return JSON.stringify(formations)}function ListingFilter(){this.SelectFilter=function(a,b){var c=UpdateQueryString(window.location.href,b,a);window.location.href=c}}angular.module("AVFC",["chart.js","ngAnimate","ngSanitize","streamPayments"]).config(["ChartJsProvider","$animateProvider",function(a,b){b.classNameFilter(/is-animated/),a.setOptions({chartColors:["#FF5252","#FF8A80"],responsive:!0,maintainAspectRatio:!1})}]),angular.module("AVFC").config(["$qProvider",function(a){a.errorOnUnhandledRejections(!1)}]),angular.module("AVFC").controller("ArticleListing",["$scope","$http","restApi",function(a,b,c){"use strict";function d(a,b){for(var c=0,d=b.length;c<d;c++)for(var e=b[c].Date,f=0,g=a.length;f<g;f++){var h=a[f].Date;if(e==h){for(var i=0,j=b[c].Articles.length;i<j;i++)a[f].Articles.push(b[c].Articles[i]);delete b[c]}}return a.concat(b)}function e(b){var e=JSON.stringify({Page:a.pageNumber,NumberPerPage:b,SelectedSeasonId:a.formModel.SelectedSeasonId,SelectedMonth:a.formModel.SelectedMonth,SelectedContentTypeId:a.formModel.SelectedContentTypeId,SelectedTagId:a.formModel.SelectedTagId,SelectedAuthorId:a.formModel.SelectedAuthorId});c.postData("/api/ArticleListing/GetArticles",e).then(function(b){f=void 0!==a.articles?d(f,b):f.concat(b),a.resultCount=f.length,a.articles=f,a.pageNumber++,a.resultsEnd=0===b.length})}var f=[];a.pageNumber=1,a.resultCount=null,a.resultsEnd=!1,a.formModel={Items:10,SelectedSeasonId:"",SelectedMonth:"",SelectedContentTypeId:"",SelectedTagId:"",SelectedAuthorId:""},a.initialize=function(b){a.formModel.SelectedAuthorId=$("#SelectedAuthorId").val(),a.formModel.SelectedTagId=$("#CategoryDropDownList").val(),a.formModel.SelectedContentTypeId=$("#ContentTypeDropDownList").val(),a.formModel.SelectedSeasonId=$("#SeasonDropDownList").val(),a.loadArticles(b)},a.loadArticles=function(a){a=void 0!==a?a:10,e(a)},a.reloadArticles=function(b){f=[],a.pageNumber=1,b=void 0!==b?b:10,e(b)}}]),angular.module("AVFC").controller("ArticleWidget",["$scope","$http","restApi",function(a,b,c){"use strict";a.loadRelated=function(b){var d={itemId:b};a.showRelated=!1,c.getData("/api/RelatedArticles/Get",d).then(function(b){a.related=b,b.length&&(a.showRelated=!0)})},a.loadArticles=function(b){var d=JSON.stringify({Page:1,NumberPerPage:5,SelectedTagId:b});c.postData("/api/ArticleListing/GetLatestArticles",d).then(function(b){a.articles=b})},a.loadPopular=function(){c.getData("/api/ArticleListing/GetPopularArticles").then(function(b){a.popular=b})}}]),angular.module("AVFC").controller("CommentsStatisticsController",["$scope","$attrs",function(a,b){a.comments=-1,a.shares=-1,a.initialize=function(){}}]),angular.module("AVFC").controller("FixtureDetail",["$scope","$http","restApi",function(a,b,c){"use strict";var d=!1;a.formResultText=function(a){var b=null;switch(a){case-1:b="L";break;case 0:b="D";break;case 1:b="W"}return b},a.getFixtureDetail=function(b){d||(a.detailsLoading=!0,c.getData("/api/Fixtures/GetFixtureDetails",{fixtureId:b}).then(function(b){a.details=b,b&&(d=!0,a.detailsLoading=!1)}))}}]),angular.module("AVFC").controller("FixturesListing",["$scope","$http","restApi","$filter","activeToggle","timeHelper",function(a,b,c,d,e,f){"use strict";function g(b,d){a.isLoading=!0,a.noResults=!1,c.getData("/api/Fixtures/GetFixtureSummaries",{teamId:b,seasonId:d,loadPrevious:a.showPrevious}).then(function(b){a.hasPreviousFixtures=b.HasPreviousFixtures,h=b.Summaries,a.fixtures=h,a.filter(),h.length<4&&!1===a.showPrevious&&a.reloadFixtures(),angular.forEach(a.fixtures,function(b,c){angular.forEach(b.FixtureSummaries,function(b,d){a.fixtures[c].FixtureSummaries[d].KickOffDate=f.getDate(a.fixtures[c].FixtureSummaries[d].KickOffUtc,!0),a.fixtures[c].FixtureSummaries[d].KickOffTime=f.getTime(a.fixtures[c].FixtureSummaries[d].KickOffUtc,"h:m")})}),a.isLoading=!1})}var h={};a.active=!1,a.isLoading=!1,a.showPrevious=!1,a.hasPreviousFixtures=!1,a.noResults=!1,a.isResult=function(a){return Date.parse(new Date(a))<Date.parse(new Date)},a.toggleFixture=e.multiTrigger,a.fixtureActive=e.multiActive,a.formResultText=function(a){var b=null;switch(a){case-1:b="L";break;case 0:b="D";break;case 1:b="W"}return b},a.teamAbr=function(a){return a.substring(0,3).toUpperCase()},a.filter=function(){var b,c,d,e,f=[];for(d=0,c=0;d<h.length;d++){for(b=h[d].FixtureSummaries,f.push({MonthYear:h[d].MonthYear,FixtureSummaries:[]}),e=0;e<b.length;e++)a.competitionTypeId!==b[e].CompetitionTypeId&&"00000000-0000-0000-0000-000000000000"!==a.competitionTypeId||f[d].FixtureSummaries.push(b[e]);0===f[d].FixtureSummaries.length&&(delete f[d].MonthYear,c++)}a.fixtures=f,a.noResults=c===d,!0===a.noResults&&!1===a.showPrevious&&a.reloadFixtures()},a.initFixtures=function(b,c,d){a.defaultTeam=b,a.seasonId=c,a.competitionTypeId=d,g(a.defaultTeam,a.seasonId)},a.reloadFixtures=function(){a.showPrevious=!0,g(a.defaultTeam,a.seasonId)}}]),angular.module("AVFC").controller("GalleryListing",["$scope","$http","restApi",function(a,b,c){"use strict";function d(b){var d=JSON.stringify({Page:a.pageNumber,NumberPerPage:b,SelectedSeasonId:a.formModel.SelectedSeasonId,SelectedMonth:a.formModel.SelectedMonth,SelectedTagId:a.formModel.SelectedTagId});c.postData("/api/Gallery/GetGalleries",d).then(function(b){e=e.concat(b),a.resultCount=e.length,a.galleries=e,a.pageNumber++,0===b.length?a.resultsEnd=!0:a.resultsEnd=!1})}var e=[];a.pageNumber=1,a.resultCount=null,a.resultsEnd=!1,a.formModel={Items:10,SelectedSeasonId:"",SelectedMonth:"",SelectedTagId:""},a.loadGalleries=function(a){a=void 0!==a?a:10,d(a)},a.reloadGalleries=function(b){e=[],a.pageNumber=1,b=void 0!==b?b:10,d(b)}}]),angular.module("AVFC").controller("LeagueTable",["$scope","$http","restApi","activeToggle","urlParams",function(a,b,c,d,e){"use strict";function f(){a.isLoading=!0,c.getData("/api/LeagueTable/GetLeagueRankings",{competitionId:a.competition}).then(function(b){a.league=b,a.isLoading=!1,a.leagueSize=b.Rankings.length-1})}a.initLeague=function(b){var c=e.getQuery(b);a.competition=!1!==c?c.cid:b,f()},a.reloadLeague=function(){f()}}]),angular.module("AVFC").controller("LeagueTableDetail",["$scope","$http","restApi",function(a,b,c){"use strict";function d(b){h||(a.detailsLoading=!0,c.getData("/api/leaguetable/GetLeagueData",{competitionId:f,clubId:g}).then(function(c){a.clubDetail=c,h=!0,e(c.Position,b),a.detailsLoading=!1}))}function e(b,c){for(var d=[],e=0;e<b.length;e++)d.push((e+1).toString());a.labels=d,a.options={pointDot:!1,bezierCurve:!1,datasetFill:!1,scaleOverride:!0,scaleSteps:c,scaleStepWidth:-1,scaleStartValue:c+1,scaleFontSize:10,responsive:!0,showTooltips:!1},a.data=[b],a.colours=[{strokeColor:"#999"}]}var f,g,h=!1;a.setClubDetails=function(a,b){f=a,g=b},a.detailsLoading=!1,a.getLeagueDetail=function(a){d(a)},a.getHomeTeamDetails=function(b,c){b&&(d(c),a.panelActive=!0,a.homeTeamActive=!0)},a.formResultText=function(a){var b=null;switch(a){case-1:b="Lose";break;case 0:b="Draw";break;case 1:b="Win"}return b}}]),angular.module("AVFC").controller("MatchCentreController",["$scope","$attrs","$http","timeHelper","restApi",function(a,b,c,d,e){"use strict";function f(){c.get(u.formationsURI).then(function(b){a.formations=b.data[0]},function(a){console.log("Error: Could not load foramtions.")})}function g(b){if(a.formations.hasOwnProperty(a.data[b].FormationType)||(a.data[b].FormationType=r),null!==a.data[b])for(var c=a.data[b].FormationType,d=a.formations[c],e=0,f=a.data[b].Players.length;e<f;e++){var g=u.pitch.pitchWidth,h=u.pitch.pitchHeight,i=d[e+1].x,j=d[e+1].y,k=4,l=12,m=i/g*100-k,n=j/h*100-l;a.data[b].displayOption="block",a.data[b].Players[e].position={xPos:i,yPos:j,leftPos:m,topPos:n}}}function h(a){s.commentary.defaultParams.FixtureItemId=a.fixtureId;for(var b in s.matchDay.defaultParams)if(s.matchDay.defaultParams.hasOwnProperty(b)){var c=b.charAt(0).toLowerCase()+b.slice(1);void 0!==a[c]&&(s.matchDay.defaultParams[b]=a[c])}}function i(b){!1!==s[b].intervalTime&&(a[b+"Interval"]=setInterval(function(){j(b)},s[b].intervalTime))}function j(b,c){void 0!==c&&c||(c=null),e.postData(s[b].uri,s[b].defaultParams).then(function(d){return void 0!==d&&(a[s[b].scopeUpdate]=d,a[s[b].scopeUpdate]=d,"commentary"==b&&twttr.widgets.load(),void 0!==c&&null!==c&&c(),void 0!==a[s[b].scopeUpdate].MatchStatus&&k()&&l()),!0})}function k(){for(var b in t)if(t.hasOwnProperty(b)&&-1!=jQuery.inArray(a.data.MatchStatus,t[b]))return q=b,a.matchStatus=q,!0;return!1}function l(){return a.homePage||(g("HomeFormation"),g("AwayFormation")),"live"===q?m():"preMatch"===q?($(".match-score-summary").addClass("pre-match"),n()):void 0}function m(){"PM"===a.data.MatchTime&&(a.data.MatchTime=0),a.homePage&&($(".match-center-home-tab").trigger("click"),$(".slick-navigation-hero .slick-slide").removeClass("slick-active"),$(".slick-carousel-hero, .slick-navigation-hero").slick("slickPause"),a.homePage=!1);for(var b in s)if(s.hasOwnProperty(b)&&void 0===a[b+"Interval"])return void i(b)}function n(){var b=Date.parse(d.reFormatUTC(a.data.KickOffUTC));b-Date.parse(new Date)>0?(o(b),a.preMatchInterval=setInterval(function(){o(b),a.$apply()},1e3)):p()}function o(b){var c=["matchCountDown.days","matchCountDown.hours","matchCountDown.minutes","matchCountDown.seconds"];a.matchCountDown=d.getTimeDiff(b),a.$watch(c,function(){a.matchCountDown.days<=0&&a.matchCountDown.hours<=0&&a.matchCountDown.minutes<=0&&a.matchCountDown.seconds<=0&&(delete a.matchCountDown,clearInterval(a.preMatchInterval),p()),a.homePage&&a.matchCountDown.days<=0&&a.matchCountDown.hours<=2&&!1===a.matchTabActive&&(a.matchTabActive=!0,$(document).ready(function(){$("#MatchCenterTab").trigger("click")}))})}function p(){a.data.MatchTime=0,a.homePage?m():($(".match-score-summary").removeClass("pre-match"),setTimeout(function(){var a=location.href;a.indexOf("?matchdetails=1")>0?m():location.href=location.href.substring(0,a.indexOf("?matchreport=1"))+"?matchdetails=1"},6e4))}var q;a.matchTabActive=!1;var r="442";a.homePage=!1;var s={matchDay:{uri:"/api/matchday/GetMatchDayFixture",scopeUpdate:"data",intervalTime:6e4,runInit:!0,defaultParams:{FixtureId:null,LoadClubs:!0,LoadPlayers:!0,LoadLineUps:!0,LoadFormations:!0,LoadGoalScorers:!0,LoadGoalSummaries:!0,LoadBookings:!1,LoadCompetition:!0,LoadVenue:!0}},commentary:{uri:"/api/Commentary/GetCommentary",scopeUpdate:"commentary",intervalTime:12e4,runInit:!0,defaultParams:{FixtureItemId:null,StartingId:"",RetrieveOlderItems:!1}},addCommentary:{uri:"/api/Commentary/AddCommentary",scopeUpdate:"commentaryResponse",intervalTime:!1,runInit:!1,defaultParams:{FixtureId:null,Comment:null}},playerStats:{uri:"/api/PlayerStatistics/GetPlayerStatistics",scopeUpdate:"playerStats",intervalTime:!1,runInit:!1,defaultParams:{FixtureId:null,PlayerId:null}}},t={live:["FirstHalf","HalfTime","SecondHalf","ExtraFirstHalf","ExtraHalfTime","ExtraSecondHalf","ShootOut","FullTime90","FullTimePens"],fullTime:["Abandoned","Postponed","FullTime"],preMatch:["PreMatch"]},u={formationsURI:"/Scripts/Logic/Angular/Data/MatchCentre/formations.json",pitch:{pitchWidth:294,pitchHeight:270}};a.init=function(c){null===b.fixtureId&&void 0===b.fixtureId||h(b),void 0===a.formations&&f();for(var d in s)s.hasOwnProperty(d)&&s[d].runInit&&j(d);b.homePage&&(a.homePage=!0)},a.showPlayerStats=function(b,c){c=void 0!==c?c:"#480024";var d=$(b.currentTarget),e="js-show-ps-content",f=d.attr("data-team").indexOf("home")>-1?"home":"away",g=$("."+d.attr("data-team")),h=parseInt(d.attr("data-opta-pid").replace("p","")),i=d.find(".js-player-loading"),k=d.find(".js-player-number"),l=setInterval(function(){(a.playerStatsHome||a.playerStatsAway)&&(i.hide(),k.show(),m(),n())},1e3),m=function(){clearInterval(l)},n=function(){g.find(".line-ups-stats").addClass(e),g.find(".js-line-up-wrapper .line-ups-col").css({opacity:0}),p(),o(c)},o=function(a){a=void 0!==a?a:"#480024",g.find(".small-pie-chart").each(function(){var b=$(this),c=(b.attr("data-chart-home-color"),parseInt(b.attr("data-chart-percentage"))),d=[{title:"Home",value:c,color:a},{title:"Away",value:100-c,color:"#cccccc"}],e={percentageInnerCutout:70,segmentStrokeWidth:3};$(this).find("svg").length>0&&$(this).find("svg").remove(),b.drawDoughnutChart(d,e)})},p=function(){$(".line-up-"+f+"-team.starter.selected").trigger("click"),$(".line-up-"+f+'-team *[data-pid="'+h+'"]').trigger("click")};i.css({display:"inline-block"}),k.hide(),s.playerStats.defaultParams.FixtureId=d.attr("data-fixture-id"),s.playerStats.defaultParams.PlayerId=d.attr("data-player-id"),s.playerStats.scopeUpdate="home"===f?"playerStatsHome":"playerStatsAway",j("playerStats",function(){a.chartType="Radar",a.chartLabels=["Shots","TakeOns","Passes","Crosses","Tackles","Interceptions","Clearances","Fouls"],a.chartData=[[a[s.playerStats.scopeUpdate].Shots,a[s.playerStats.scopeUpdate].TakeOns,a[s.playerStats.scopeUpdate].Passes,a[s.playerStats.scopeUpdate].Crosses,a[s.playerStats.scopeUpdate].Tackles,a[s.playerStats.scopeUpdate].Interceptions,a[s.playerStats.scopeUpdate].Clearances,a[s.playerStats.scopeUpdate].Fouls]],a[s.playerStats.scopeUpdate].PassingAccuracy<0&&(a[s.playerStats.scopeUpdate].PassingAccuracy=0),a[s.playerStats.scopeUpdate].TacklesWon<0&&(a[s.playerStats.scopeUpdate].TacklesWon=0),"home"===f?a.chartDataHome=a.chartData:a.chartDataAway=a.chartData})},a.isNan=function(a){return isNaN(a)?"0":a},a.hidePlayerStats=function(a,b){b=b.toLowerCase(),$(".line-up-"+b+"-team .selected[data-pid]").click();var c=$(a.currentTarget),d=$("Home"===c.attr("data-team")?".line-up-home-team":".line-up-away-team");d.find(".line-ups-stats").removeClass("js-show-ps-content"),d.find(".js-line-up-wrapper .line-ups-col").removeAttr("style")},a.isEmpty=function(a){return void 0!==a&&0!==a.length&&""!==a},a.percentage=function(a,b){return void 0===a&&(a=0),void 0===b&&(b=0),0===a?0:Math.round(parseFloat(b)/parseFloat(a)*100)},a.addComment=function(){if(a.commentResponseMsg=[],a.form.comment.length<5)return a.commentResponseClass="form-error",void a.commentResponseMsg.push("Comment must be at least 5 characters long.");s.addCommentary.defaultParams.FixtureId=s.matchDay.defaultParams.FixtureId,s.addCommentary.defaultParams.Comment=a.form.comment,j("addCommentary",function(){a.commentaryResponse.success?(a.commentResponseClass="form-success",a.commentResponseMsg.push("Your comment has been sent and is waiting approval."),a.form=null):(a.commentResponseClass="form-error",a.commentResponseMsg.push("Something went wrong there, please try again in a few minutes."))})}}]),angular.module("AVFC").controller("NextFixture",["$scope","$http","restApi","$filter","$location","urlParams","timeHelper",function(a,b,c,d,e,f,g){"use strict";function h(b){c.getData("/api/Fixtures/GetNextFixture",{teamId:b}).then(function(b){a.nextMatch=b,b&&(a.hasNextMatch=!0,a.nextMatchCount=g.getTimeDiff(g.reFormatUTC(b.KickOffUtc)),a.kickOffTime=g.getTime(b.KickOffUtc,"h:m"),a.kickOffDate=g.getDate(b.KickOffUtc))})}var i=f.getQuery("tid");Date.parse(new Date);a.hasNextMatch=!1,a.initNextMatch=function(b){a.defaultTeam=b,h(i?i:a.defaultTeam)},a.formatKickOffDate=function(a){function b(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"}var c=["January","February","March","April","May","June","July","August","September","October","November","December"],d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e=new Date(a),f=d[e.getDay()],g=(e.getFullYear(),c[e.getMonth()]),h=e.getDate();e.getHours(),e.getMinutes(),e.getSeconds();return f+" "+h+b(h)+" "+g}}]),angular.module("AVFC").controller("PlayerGallery",["$scope","$http","restApi",function(a,b,c){"use strict";function d(a){var b=window.location.href,c=new RegExp("[?&]"+a+"=([^?#]*)","i"),d=c.exec(b);return d?d[1]:null}function e(){$(".gallery-link-btn").each(function(){var a=$(this),b=a.attr("href");b&&""!==b||a.remove()}),$(".gallery-sponsor-image").each(function(){var a=$(this),b=a.attr("src");b&&""!==b||a.remove()})}function f(a){$('a[data-image-id="'+a+'"]').trigger("click")}function g(b){var d={galleryguid:b};if(c.getData(i,d).then(function(b){for(var c=0,d=b.Images.length;c<d;c++){var e=b.Images[c];e.SponsorUrl=b.SponsorUrl,e.SponsorTitle=b.SponsorTitle,a.images.push(e)}h()}),!1!==a.images)return!0}function h(){for(var b=0,c=a.images.length;b<c;b++)a.images[b].ShareUrl=window.location.href.split("?")[0]+"?galleryimage="+a.images[b].Id}var i="/api/gallery/getgallery";a.images=[],a.init=function(b){var c=d("galleryimage");b&&g(b),a.$on("ngRepeatFinished",function(a){null!==c&&f(c)})},a.openLightBox=function(a,b){void 0!==a&&a.preventDefault(),$('[data-gallery-id="'+b+'"]').find(".popup-gallery a:first-child").click(),e(),$(".mfp-arrow").on("click",null,function(){e()}),$(document).keydown(function(a){37!=a.keyCode&&39!=a.keyCode||$(".gallery-popup-wrapper").length>0&&e()})}}]),angular.module("AVFC").controller("PlayerLinking",["$scope","$http","restApi",function(a,b,c){"use strict";function d(a){return a.replace(/á/g,"a").replace(/é/g,"e").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u")}function e(a,b,c){var e=a.replace(/  +/g," "),f=new RegExp("\\b"+d(e).toLowerCase()+"\\b","i");c.find("p").contents().filter(function(){return 3===this.nodeType&&f.test(this.nodeValue.toLowerCase())}).replaceWith(function(){return(this.nodeValue||"").replace(f,function(a){if(a)return'<a href="'+b+'">'+e+"</a>"})})}function f(a){for(var b=$(".cms-content"),c=0;c<a.length;c++)e(a[c].Name,a[c].ProfileUrl,b)}!function(){c.getData("/api/PLayerLink/AllPlayers").then(function(a){f(a)})}()}]),angular.module("AVFC").controller("PollController",["$scope","$location","$http","restApi",function(a,b,c,d){function e(b,c,e){var g="GET"==f[b].method?"getData":"postData";d[g](f[b].uri,f[b].params).then(function(d){return void 0!==d&&(a[f[b].scopeUpdate]=d,void 0!==e&&e(),null!==c&&void 0!==c&&f[b].collections[c]()),!0})}var f={sendPoll:{uri:"/api/Poll/Post",method:"POST",scopeUpdate:"results",params:{PollId:null,SelectedOptionId:null}}};a.initialize=function(){f.sendPoll.params.PollId=$('.poll-answers input[type="hidden"').val()},a.send=function(a){if(void 0!==a)return f.sendPoll.params.SelectedOptionId=a,void e("sendPoll",null,function(){$(".poll-answers").hide()});console.log("error")}}]),angular.module("AVFC").controller("RelatedArticles",["$scope","$http","restApi",function(a,b,c){"use strict";function d(b){var d={itemId:b};c.getData("/api/RelatedArticles",d).then(function(b){a.articles=b})}a.loadArticles=function(a){d(a)}}]),angular.module("AVFC").controller("SearchController",["$scope","restApi","urlParams",function(a,b,c){"use strict";function d(){var b={page:a.pageNumber,numberPerPage:a.numItems,searchTerm:a.formModel.searchTerms,selectedContent:a.formModel.selectedContentType,selectedTag:a.formModel.selectedCategory,selectedSeason:a.formModel.selectedSeason,selectedMonth:a.formModel.selectedMonth};1===b.page&&g("searchPlayers",b,f),1===b.page&&(a.searchResults.ContentSearchResults=[]),g("search",b,e)}function e(){void 0===a.searchResults.ContentSearchResults&&(a.searchResults.ContentSearchResults=[]),a.searchResults.ContentSearchResults=a.searchResults.ContentSearchResults.concat(a.searchResultsPage.ContentSearchResults)}function f(){var a=$(".search-player");a.hasClass("slick-initialized")&&a.slick("unslick"),setTimeout(function(){a.slick({arrows:!0,dots:!0,infinite:!1,slidesToShow:1,slidesToScroll:1,dotsClass:"custom_paging",customPaging:function(a,b){return b+1}})},1)}function g(c,d,e){var f="GET"===h[c].method?"getData":"postData";b[f](h[c].uri,d).then(function(b){return void 0!==b&&(a[h[c].scopeUpdate]=b,void 0!==e&&e()),!0})}var h={search:{uri:"api/Search/Search",method:"POST",scopeUpdate:"searchResultsPage"},searchPlayers:{uri:"api/Search/SearchPlayers",method:"POST",scopeUpdate:"playersSearchResults"}};a.pageNumber=1,a.numItems=10,a.searchResults={},a.formModel={searchTerms:"",selectedCategory:"",selectedContentType:"",selectedSeason:"",selectedMonth:""},a.initialize=function(b){a.formModel.numItems=b,a.$watchGroup(["formModel.selectedCategory","formModel.selectedContentType","formModel.selectedSeason","formModel.selectedMonth"],function(a,b){a!==b&&d()});var e=c.getQuery("q");!1!==e&&(a.formModel.searchTerms=e),d()},a.search=function(){d()},a.loadMore=function(){a.pageNumber+=1,d()},a.handleKeypress=function(a){13===a&&d()}}]),angular.module("AVFC").controller("StartingXIController",["$scope","$location","$anchorScroll","$http","$attrs","restApi",function(a,b,c,d,e,f){function g(){for(var b=a.selectedPlayers.length,c=0,d=0,e=b;d<e;d++)void 0===a.selectedPlayers[d].PlayerId&&c++;return!(11!=b||c>0)||c}function h(){for(var b=[],c=0,d=a.selectedPlayers.length;c<d;c++)b.push(a.selectedPlayers[c].PlayerId);q.saveFormation.params.PlayerIds=b}function i(){$(".starting-XI-image img").on("load",function(){$(".starting-XI__form--submit .btn").show(),$(".js-starting-XI-loading").hide(),$(".starting-XI-image").trigger("click")})}function j(){d.get(q.getFormation.uri).success(function(b){a.formations=b[0],k()})}function k(){a.currentFormation=a.formations[0],q.saveFormation.params.FormationType=a.currentFormation.title}function l(b){var c=b[0].PlayerId,d=b[1];for(var e in a.team)for(var f=0,g=a.team[e].length;f<g;f++)if(a.team[e][f].selectId==d&&(delete a.team[e][f].selectId,delete a.team[e][f].taken),a.team[e][f].PlayerId==c){a.team[e][f].taken=!0,a.team[e][f].selectId=d;for(var h=0,i=a.selectedPlayers.length;h<i;h++)void 0!==a.selectedPlayers[h]&&a.selectedPlayers[h].selectId==d&&delete a.selectedPlayers[h];if(void 0!==a.team[e][f].selectId){var j=m(a.team[e].acrom,a.team[e][f].selectId);a.selectedPlayers[j]={Forename:a.team[e][f].Forename,Surname:a.team[e][f].Surname,ShirtNumber:a.team[e][f].ShirtNumber,PlayerId:a.team[e][f].PlayerId,selectId:a.team[e][f].selectId,taken:a.team[e][f].taken,position:a.team[e].acrom}}}}function m(b,c){var d;switch(b){case"FD":d=a.currentFormation.MF+a.currentFormation.DF+1;break;case"DF":d=1;break;case"MF":d=a.currentFormation.DF+1;break;default:d=0}return parseInt(c.split("-")[1])+d}function n(){for(var b=0,c=11;b<c;b++)a.selectedPlayers[b]={}}function o(){a.selectedPlayers=[],n(),$(".player-select").each(function(){$(this).val(this.defaultValue).trigger("change")})}function p(b,c,d){var e="GET"==q[b].method?"getData":"postData";f[e](q[b].uri,q[b].params).then(function(e){return void 0!==e&&(a[q[b].scopeUpdate]=e,void 0!==d&&d(),null!==c&&void 0!==c&&q[b].collections[c]()),!0})}var q={getNextFixture:{uri:"/api/StartingXI/GetNextFixture",method:"GET",scopeUpdate:"fixture",params:null},getTeam:{uri:"/api/StartingXI/GetTeam",method:"GET",scopeUpdate:"team",params:null,collections:{getAcronyms:function(){a.team.Goalkeepers.acrom="GK",a.team.Defenders.acrom="DF",a.team.Midfielders.acrom="MF",a.team.Forwards.acrom="FD"}}},getFormation:{uri:"/Scripts/Logic/Angular/Data/StartingXI/formations.json",method:"GET",scopeUpdate:"formations",params:null},saveFormation:{uri:"/api/StartingXI/SaveFormation",scopeUpdate:"images",method:"POST",params:{FixtureId:null,FormationType:null,PlayerIds:[]}}};a.currentFormation={GK:1,DF:4,MF:3,FD:3},a.selectedPlayers=[],a.initialize=function(){n(),j(),p("getTeam","getAcronyms"),p("getNextFixture",null,function(){q.saveFormation.params.FixtureId=a.fixture.FixtureId})},a.formationChange=function(b){a.currentFormation=b,q.saveFormation.params.FormationType=b.title,o()},a.playerChange=function(a){l(a)},a.listToggle=function(a){$(".starting-XI__select h3").removeClass("active"),$(a.currentTarget).toggleClass("active")},a.filterByPlayerRegister=function(a,b){return function(a){return!!(a.taken&&a.selectId==b||void 0===a.taken&&void 0===a.selectId)}},a.create=function(b){var d=g();if(b.preventDefault(),h(),!0===d)return $(".js-starting-XI-loading").show(),$(".starting-XI__form--submit .btn").hide(),void p("saveFormation",null,function(){void 0===a.images.Url&&(a.validatedClass="error",a.validated="Server error."),delete a.validatedClass,delete a.validated,delete a.preview,i()});c("startingXI"),a.validatedClass="error",a.validated="Line up was not complete, you have missed "+d+" players."},a.togglePreview=function(b){var c=$(b.currentTarget);!1===a.preview||void 0===a.preview?(c.text("Hide quick preview"),a.preview=!0):(c.text("Show quick preview"),a.preview=!1)}}]),angular.module("AVFC").controller("streamAMGController",["$scope","streamPayments",function(a,b){"use strict";a.init=function(c){b.getKSession({entryId:c},function(b){a.EntrySession=b,a.$apply()})}}]),angular.module("AVFC").controller("Tabs",["$scope",function(a){"use strict";a.viewTab=null,a.setTab=function(b){a.viewTab===b?a.viewTab=null:a.viewTab=b},a.activePanel=function(b){return a.viewTab===b}}]),angular.module("AVFC").controller("VideoListing",["$scope","$http","restApi","$sce","$filter","$attrs",function(a,b,c,d,e,f){"use strict";function g(b){var d={ChannelId:b,NumberPerPage:j,Page:i,Tag:""};c.postData(h,d).then(function(b){if(0===a.videos.length)a.videos=b;else for(var c=0;c<b.length;c++)a.videos.push(b[c]);b.length<j&&(a.showLoadMore=!1),i++})}var h="/api/videolisting/GetVideos",i=1,j=12;a.videos=[],a.showLoadMore=!0,a.init=function(){g(f.channel)},a.loadVideos=function(a){g(a)},a.jsonSnippet=function(a,b,c,f){var g={"@context":"http://schema.org","@type":"VideoObject",name:a,description:b,thumbnailUrl:c,uploadDate:f};return d.trustAsHtml(e("json")(g))}}]),angular.module("AVFC").controller("VideoWidgetController",["$scope","$http","restApi",function(a,b,c){"use strict";a.loadRelated=function(b){var d={itemId:b};a.showRelated=!1,c.getData("/api/VideoListing/GetRelatedVideos",d).then(function(b){a.related=b,b.length&&(a.showRelated=!0)})},a.loadLatest=function(){c.getData("/api/VideoListing/GetLatestVideos").then(function(b){a.latest=b})}}]),angular.module("AVFC").directive("onFinishRender",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){!0===b.$last&&a(function(){b.$emit(d.onFinishRender)})}}}]),angular.module("streamPayments",[]).factory("streamPayments",["$window",function(a){return a.streamPayments}]),angular.module("AVFC").filter("ordinalDate",["$filter",function(a){var b=["th","st","nd","rd"];return function(c,d){if(isNaN(c))return"";var e=a("date")(c,d),f=parseInt(e.slice(-2)),g=f<30?f%20:f%30;return e+(g<=3?b[g]:b[0])}}]),angular.module("AVFC").filter("secondsToTime",function(){return function(a){if(isNaN(a))return"";var b=new Date(0,0,0,0,0,0,0);return b.setSeconds(a),b}}),angular.module("AVFC").filter("sanitize",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),angular.module("AVFC").filter("range",function(){return function(a,b){b=parseInt(b);for(var c=0;c<b;c++)a.push(c);return a}});var x={left:15,right:279,centre:147,centreCentreLeft:86,centreLeftLeft:60,centreLeft:105,centreCentreRight:211,centreRightRight:229,centreRight:187},y={gk:270,d5:205,d:195,dml5:160,dmt5:120,dm:140,m:110,am5:70,am:80,f:18},formations={};formations[4231]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d+15},3:{x:x.centreLeft,y:y.d+15},4:{x:x.centreRight,y:y.d+15},5:{x:x.right,y:y.d+15},6:{x:x.centreLeft,y:y.dm},7:{x:x.centreRight,y:y.dm},8:{x:x.left,y:y.am},9:{x:x.centre,y:y.am},10:{x:x.right,y:y.am},11:{x:x.centre,y:y.f}},formations[4321]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d},3:{x:x.centreLeft,y:y.d},4:{x:x.centreRight,y:y.d},5:{x:x.right,y:y.d},6:{x:x.centreLeftLeft,y:y.dm-15},7:{x:x.centre,y:y.dm-15},8:{x:x.centreRightRight,y:y.dm-15},9:{x:x.left,y:y.am-15},10:{x:x.right,y:y.am-15},11:{x:x.centre,y:y.f}},formations[442]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d},3:{x:x.centreLeft,y:y.d},4:{x:x.centreRight,y:y.d},5:{x:x.right,y:y.d},6:{x:x.left,y:y.m},7:{x:x.centreLeft,y:y.m},8:{x:x.centreRight,y:y.m},9:{x:x.right,y:y.m},10:{x:x.centreCentreLeft,y:y.f},11:{x:x.centreCentreRight,y:y.f}},formations[4411]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d},3:{x:x.centreLeft,y:y.d},4:{x:x.centreRight,y:y.d},5:{x:x.right,y:y.d},6:{x:x.left,y:y.m},7:{x:x.centreLeft,y:y.m},8:{x:x.centreRight,y:y.m},9:{x:x.right,y:y.m},10:{x:x.centre,y:y.am},11:{x:x.centre,y:y.f}},formations[433]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d},3:{x:x.centreLeft,y:y.d},4:{x:x.centreRight,y:y.d},5:{x:x.right,y:y.d},6:{x:x.centreLeftLeft,y:y.m},7:{x:x.centre,y:y.m},8:{x:x.centreRightRight,y:y.m},9:{x:x.centreLeftLeft,y:y.f},10:{x:x.centre,y:y.f},11:{x:x.centreRightRight,y:y.f}},formations[451]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d},3:{x:x.centreLeft,y:y.d},4:{x:x.centreRight,y:y.d},5:{x:x.right,y:y.d},6:{x:x.left,y:y.m},7:{x:x.centreCentreLeft,y:y.m},8:{x:x.centre,y:y.m},9:{x:x.centreCentreRight,y:y.m},10:{x:x.right,y:y.m},11:{x:x.centre,y:y.f}},formations[352]={1:{x:x.centre,y:y.gk},2:{x:x.centreLeftLeft,y:y.d},3:{x:x.centre,y:y.d},4:{x:x.centreRightRight,y:y.d},5:{x:x.left,y:y.m},6:{x:x.centreCentreLeft,y:y.m},7:{x:x.centre,y:y.m},8:{x:x.centreCentreRight,y:y.m},9:{x:x.right,y:y.m},10:{x:x.centreLeft,y:y.f},11:{x:x.centreRight,y:y.f}},formations[4141]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d},3:{x:x.centreLeft,y:y.d},4:{x:x.centreRight,y:y.d},5:{x:x.right,y:y.d},6:{x:x.centre,y:y.dm},7:{x:x.left,y:y.am},8:{x:x.centreLeft,y:y.am},9:{x:x.centreRight,y:y.am},10:{x:x.right,y:y.am},11:{x:x.centre,y:y.f}},formations[343]={1:{x:x.centre,y:y.gk},2:{x:x.centreLeftLeft,y:y.d},3:{x:x.centre,y:y.d},4:{x:x.centreRightRight,y:y.d},5:{x:x.left,y:y.m},6:{x:x.centreLeft,y:y.m},7:{x:x.centreRight,y:y.m},8:{x:x.right,y:y.m},9:{x:x.centreLeftLeft,y:y.f},10:{x:x.centre,y:y.f},11:{x:x.centreRightRight,y:y.f}},formations[41212]={1:{x:x.centre,y:y.gk},2:{x:x.left,y:y.d5},3:{x:x.centreLeft,y:y.d5},4:{x:x.centreRight,y:y.d5},5:{x:x.right,y:y.d5},6:{x:x.centre,y:y.dml5},7:{x:x.centreLeft,y:y.dmt5},8:{x:x.centreRight,y:y.dmt5},9:{x:x.centre,y:y.am5},10:{x:x.centreLeft,y:y.f},11:{x:x.centreRight,y:y.f}},_modifyFormationData(),angular.module("AVFC").service("activeToggle",[function(){var a=[];this.multiTrigger=function(b){if(-1==a.indexOf(b))a.push(b);else{var c=a.indexOf(b);a.splice(c,1)}},this.multiActive=function(b){if(-1!=a.indexOf(b))return!0}}]),angular.module("AVFC").service("timeHelper",[function(){function a(a){if("string"==typeof a){var b=a.split("-"),c=b[2].split(" ")[1].split(":");return new Date(b[0],d.indexOf(b[1]),b[2].split(" ")[0],c[0],c[1],c[2])}}var b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c=["January","February","March","April","May","June","July","August","September","October","November","December"],d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.getTimeDiff=function(a){var b=void 0===typeof _endTime?0:a-Date.parse(new Date);return{diff:b,days:Math.floor(b/864e5),hours:Math.floor(b/36e5%24),minutes:Math.floor(b/1e3/60%60),seconds:Math.floor(b/1e3%60)}},this.getTime=function(b,c){var d,e={},f=a(b),g="h:m:s";e.h=(f.getHours()<10?"0":"")+f.getHours(),e.m=(f.getMinutes()<10?"0":"")+f.getMinutes(),e.s=(f.getSeconds()<10?"0":"")+f.getSeconds(),void 0===c&&(c=g);for(var h=c.split(":"),i=0,j=h.length;i<j;i++)d=void 0!==d?d+":"+e[h[i]]:e[h[i]];return d},this.getDate=function(e,f){var g=a(e),h=b[g.getDay()],i=(g.getFullYear(),c[g.getMonth()]),j=d[g.getMonth()],k=g.getDate(),l=function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"}(k);return void 0===f?h+" "+k+l+" "+i:j+" "+k+l},this.uctToTimestamp=function(a){return new Date(a).getTime()},this.reFormatUTC=function(b){return a(b)}}]),angular.module("AVFC").service("restApi",["$http",function(a){"use strict";var b;this.getData=function(c,d){return d=void 0!==d?d:null,b=a({method:"GET",url:c,params:d}).then(function(a){return a.data},function(a){
return a.statusText?console.log(a.statusText):console.log("Error: Web service not found"),!1})},this.postData=function(c,d){return d=void 0!==d?d:null,b=a({method:"POST",url:c,data:d,headers:{"Content-Type":"application/json"}}).then(function(a){return a.data},function(a){return a.statusText?console.log(a.statusText):console.log("Error: Web service not found"),!1})}}]),angular.module("AVFC").service("urlParams",[function(){this.getQuery=function(a){function b(){var a=window.location.search.substring(1);if(a.length){var b=a.split("&"),c={};return b.forEach(function(a){a=a.split("="),c[a[0]]=decodeURIComponent(a[1]||"")}),c}}return void 0!==b()&&(void 0!==a&&void 0!==b()[a]?b()[a]:b())}}]);